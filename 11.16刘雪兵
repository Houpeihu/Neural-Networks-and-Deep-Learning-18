{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Tensorflow版本为： 2.3.1\n"
     ]
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "\n",
    "print(\"Tensorflow版本为：\",tf.__version__)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Device mapping:\n",
      "/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n",
      "/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n",
      "\n",
      "[[22. 28.]\n",
      " [49. 64.]]\n"
     ]
    }
   ],
   "source": [
    "import numpy\n",
    "import tensorflow as tf\n",
    "tf.compat.v1.disable_eager_execution() #保证sess.run()能够正常运行\n",
    "a = tf.constant([1.0, 2.0, 3.0, 4.0, 5.0, 6.0], shape=[2, 3], name='a')\n",
    "b = tf.constant([1.0, 2.0, 3.0, 4.0, 5.0, 6.0], shape=[3, 2], name='b')\n",
    "c = tf.matmul(a, b)\n",
    "sess = tf.compat.v1.Session(config=tf.compat.v1.ConfigProto(log_device_placement=True))\n",
    "print(sess.run(c))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[5.8 4.  1.2 0.2]]\n",
      "[0]\n",
      "(120, 4)\n",
      "(120, 3)\n",
      "[[1. 0. 0.]]\n",
      "Epoch 1/30\n",
      "1/1 [==============================] - 0s 128ms/step - loss: 1.1019 - accuracy: 0.3667 - val_loss: 1.1174 - val_accuracy: 0.2000\n",
      "Epoch 2/30\n",
      "1/1 [==============================] - 0s 13ms/step - loss: 1.0386 - accuracy: 0.3667 - val_loss: 1.0246 - val_accuracy: 0.5333\n",
      "Epoch 3/30\n",
      "1/1 [==============================] - 0s 14ms/step - loss: 0.9695 - accuracy: 0.6417 - val_loss: 0.9387 - val_accuracy: 0.5667\n",
      "Epoch 4/30\n",
      "1/1 [==============================] - 0s 18ms/step - loss: 0.9043 - accuracy: 0.6917 - val_loss: 0.8713 - val_accuracy: 0.5667\n",
      "Epoch 5/30\n",
      "1/1 [==============================] - 0s 14ms/step - loss: 0.8543 - accuracy: 0.6917 - val_loss: 0.8223 - val_accuracy: 0.5667\n",
      "Epoch 6/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.8118 - accuracy: 0.6917 - val_loss: 0.7770 - val_accuracy: 0.5667\n",
      "Epoch 7/30\n",
      "1/1 [==============================] - 0s 16ms/step - loss: 0.7680 - accuracy: 0.6917 - val_loss: 0.7381 - val_accuracy: 0.5667\n",
      "Epoch 8/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.7284 - accuracy: 0.6917 - val_loss: 0.7047 - val_accuracy: 0.5667\n",
      "Epoch 9/30\n",
      "1/1 [==============================] - 0s 17ms/step - loss: 0.6902 - accuracy: 0.6917 - val_loss: 0.6758 - val_accuracy: 0.5667\n",
      "Epoch 10/30\n",
      "1/1 [==============================] - 0s 17ms/step - loss: 0.6551 - accuracy: 0.6917 - val_loss: 0.6484 - val_accuracy: 0.5667\n",
      "Epoch 11/30\n",
      "1/1 [==============================] - 0s 16ms/step - loss: 0.6218 - accuracy: 0.6917 - val_loss: 0.6183 - val_accuracy: 0.5667\n",
      "Epoch 12/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.5898 - accuracy: 0.6917 - val_loss: 0.5870 - val_accuracy: 0.5667\n",
      "Epoch 13/30\n",
      "1/1 [==============================] - 0s 14ms/step - loss: 0.5576 - accuracy: 0.6917 - val_loss: 0.5579 - val_accuracy: 0.5667\n",
      "Epoch 14/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.5254 - accuracy: 0.6917 - val_loss: 0.5339 - val_accuracy: 0.5667\n",
      "Epoch 15/30\n",
      "1/1 [==============================] - 0s 14ms/step - loss: 0.4969 - accuracy: 0.6917 - val_loss: 0.5058 - val_accuracy: 0.6000\n",
      "Epoch 16/30\n",
      "1/1 [==============================] - 0s 16ms/step - loss: 0.4729 - accuracy: 0.7250 - val_loss: 0.4771 - val_accuracy: 0.7333\n",
      "Epoch 17/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.4524 - accuracy: 0.8500 - val_loss: 0.4556 - val_accuracy: 0.7667\n",
      "Epoch 18/30\n",
      "1/1 [==============================] - 0s 13ms/step - loss: 0.4345 - accuracy: 0.8750 - val_loss: 0.4399 - val_accuracy: 0.7667\n",
      "Epoch 19/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.4180 - accuracy: 0.9000 - val_loss: 0.4270 - val_accuracy: 0.8000\n",
      "Epoch 20/30\n",
      "1/1 [==============================] - 0s 14ms/step - loss: 0.4028 - accuracy: 0.9083 - val_loss: 0.4149 - val_accuracy: 0.8000\n",
      "Epoch 21/30\n",
      "1/1 [==============================] - 0s 14ms/step - loss: 0.3887 - accuracy: 0.9167 - val_loss: 0.4023 - val_accuracy: 0.8000\n",
      "Epoch 22/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.3754 - accuracy: 0.9167 - val_loss: 0.3905 - val_accuracy: 0.8333\n",
      "Epoch 23/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.3627 - accuracy: 0.9333 - val_loss: 0.3784 - val_accuracy: 0.8667\n",
      "Epoch 24/30\n",
      "1/1 [==============================] - 0s 16ms/step - loss: 0.3505 - accuracy: 0.9333 - val_loss: 0.3669 - val_accuracy: 0.9000\n",
      "Epoch 25/30\n",
      "1/1 [==============================] - 0s 17ms/step - loss: 0.3386 - accuracy: 0.9417 - val_loss: 0.3552 - val_accuracy: 0.9000\n",
      "Epoch 26/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.3269 - accuracy: 0.9500 - val_loss: 0.3443 - val_accuracy: 0.9000\n",
      "Epoch 27/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.3153 - accuracy: 0.9583 - val_loss: 0.3332 - val_accuracy: 0.9333\n",
      "Epoch 28/30\n",
      "1/1 [==============================] - 0s 16ms/step - loss: 0.3037 - accuracy: 0.9583 - val_loss: 0.3223 - val_accuracy: 0.9333\n",
      "Epoch 29/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.2923 - accuracy: 0.9667 - val_loss: 0.3118 - val_accuracy: 0.9667\n",
      "Epoch 30/30\n",
      "1/1 [==============================] - 0s 15ms/step - loss: 0.2810 - accuracy: 0.9667 - val_loss: 0.3004 - val_accuracy: 1.0000\n",
      "Test loss: 0.30044853687286377\n",
      "Test accuracy: 1.0\n",
      "WARNING:tensorflow:From <ipython-input-8-9f24ae35647d>:113: Sequential.predict_classes (from tensorflow.python.keras.engine.sequential) is deprecated and will be removed after 2021-01-01.\n",
      "Instructions for updating:\n",
      "Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) > 0.5).astype(\"int32\")`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).\n",
      "label_pred4test:\n",
      " [0 1 1 0 2 1 2 0 0 2 1 0 2 1 1 0 1 1 0 0 1 1 1 0 2 1 0 0 1 2]\n",
      "label_init4test:\n",
      " [0 1 1 0 2 1 2 0 0 2 1 0 2 1 1 0 1 1 0 0 1 1 1 0 2 1 0 0 1 2]\n",
      "label_pred4train:\n",
      " [1 2 1 2 2 0 1 0 1 2 2 0 2 2 1 2 0 0 0 1 0 0 2 2 2 2 2 1 2 1 0 2 2 0 0 2 0\n",
      " 2 2 1 1 2 2 0 1 1 2 1 2 1 0 0 0 2 0 2 2 2 0 0 1 0 2 1 2 2 1 2 2 1 0 1 0 1\n",
      " 1 0 1 0 0 2 2 2 0 0 2 0 2 0 2 2 0 2 0 1 0 1 1 0 0 1 0 1 1 0 1 1 2 1 2 0 0\n",
      " 2 1 2 1 2 2 2 2 0]\n",
      "label_init4train:\n",
      " [1 2 1 2 2 0 1 0 1 2 2 0 2 2 1 2 0 0 0 1 0 0 2 2 2 2 2 1 2 1 0 2 2 0 0 2 0\n",
      " 2 2 1 1 2 2 0 1 1 2 1 2 1 0 0 0 2 0 1 2 2 0 0 1 0 2 1 2 2 1 2 2 1 0 1 0 1\n",
      " 1 0 1 0 0 2 2 2 0 0 1 0 2 0 2 2 0 2 0 1 0 1 1 0 0 1 0 1 1 0 1 1 1 1 2 0 0\n",
      " 2 1 2 1 2 2 1 2 0]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.datasets import load_iris\n",
    "from sklearn.model_selection import train_test_split\n",
    "import keras\n",
    "from keras.models import Sequential\n",
    "from keras.layers import Dense, Dropout\n",
    "from keras.optimizers import SGD\n",
    "from keras.models import load_model\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "\n",
    "# 保存loss和acc，画图\n",
    "class LossHistory(keras.callbacks.Callback):\n",
    "    def on_train_begin(self, logs={}):\n",
    "        self.losses = {'batch': [], 'epoch': []}\n",
    "        self.accuracy = {'batch': [], 'epoch': []}\n",
    "        self.val_loss = {'batch': [], 'epoch': []}\n",
    "        self.val_acc = {'batch': [], 'epoch': []}\n",
    "\n",
    "    def on_batch_end(self, batch, logs={}):\n",
    "        self.losses['batch'].append(logs.get('loss'))\n",
    "        self.accuracy['batch'].append(logs.get('acc'))\n",
    "        self.val_loss['batch'].append(logs.get('val_loss'))\n",
    "        self.val_acc['batch'].append(logs.get('val_acc'))\n",
    "\n",
    "    def on_epoch_end(self, batch, logs={}):\n",
    "        self.losses['epoch'].append(logs.get('loss'))\n",
    "        self.accuracy['epoch'].append(logs.get('acc'))\n",
    "        self.val_loss['epoch'].append(logs.get('val_loss'))\n",
    "        self.val_acc['epoch'].append(logs.get('val_acc'))\n",
    "\n",
    "    def loss_plot(self, loss_type):\n",
    "        iters = range(len(self.losses[loss_type]))\n",
    "        plt.figure()\n",
    "        # train acc 训练集准确率 accuracy\n",
    "        plt.plot(iters, self.accuracy[loss_type], 'r', label='train acc')\n",
    "        # loss\n",
    "        plt.plot(iters, self.losses[loss_type], 'g', label='train loss')\n",
    "        if loss_type == 'epoch':\n",
    "            # val acc 验证集准确率 validation \n",
    "            plt.plot(iters, self.val_acc[loss_type], 'b', label='val acc')\n",
    "            # val loss \n",
    "            plt.plot(iters, self.val_loss[loss_type], 'k', label='val loss')\n",
    "        plt.grid(True)\n",
    "        plt.xlabel(loss_type)\n",
    "        plt.ylabel('acc-loss')\n",
    "        plt.legend(loc=\"upper left\")\n",
    "        plt.show()\n",
    "\n",
    "\n",
    "# 获取数据\n",
    "data = load_iris()\n",
    "# print(data)\n",
    "# print(type(data))\n",
    "x = data['data']\n",
    "# print(x[1])\n",
    "y = data['target']\n",
    "# 训练集测试集划分 | random_state：随机数种子\n",
    "x_train, x_test, y_init_train, y_init_test = train_test_split(x, y, test_size=0.2, random_state=1)\n",
    "# 查看第一个样本\n",
    "print(x_test[:1])\n",
    "print(y_init_test[:1])\n",
    "\n",
    "print(x_train.shape)\n",
    "# one hot编码\n",
    "y_train = keras.utils.to_categorical(y_init_train, num_classes=3)\n",
    "print(y_train.shape)\n",
    "y_test = keras.utils.to_categorical(y_init_test, num_classes=3)\n",
    "print(y_test[:1])\n",
    "\n",
    "'''\n",
    "基于MLP（Multi-layer Perceptron）多层感知器的softmax多分类\n",
    "'''\n",
    "model = Sequential()\n",
    "# Dense(128) is a fully-connected layer with 128 hidden units.\n",
    "# in the first layer, you must specify the expected input data shape:\n",
    "# here, 4-dimensional vectors.\n",
    "model.add(Dense(128, activation='relu', input_dim=4))\n",
    "# Dropout随机失活，常用于图像识别中，防止过拟合\n",
    "# model.add(Dropout(0.2))\n",
    "model.add(Dense(64, activation='relu'))\n",
    "model.add(Dense(64, activation='relu'))\n",
    "model.add(Dense(3, activation='softmax'))\n",
    "\n",
    "# lr表示学习速率，momentum表示动量项，decay是学习速率的衰减系数(每个epoch衰减一次)\n",
    "# Nesterov的值是False或者True，表示使不使用Nesterov momentum\n",
    "# SGD随机梯度下降\n",
    "sgd = SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True)\n",
    "\n",
    "# 编译模型\n",
    "model.compile(loss='categorical_crossentropy',\n",
    "              optimizer=sgd,\n",
    "              metrics=['accuracy'])\n",
    "\n",
    "# 创建一个实例history\n",
    "history = LossHistory()\n",
    "\n",
    "# 训练\n",
    "model.fit(x_train, y_train,\n",
    "          epochs=30,  # 数据被轮30次\n",
    "          batch_size=128,\n",
    "          validation_data=(x_test, y_test),\n",
    "          callbacks=[history])\n",
    "# 保存模型\n",
    "# model.save('iris.h5')\n",
    "# 读取模型\n",
    "# model = load_model('iris.h5')\n",
    "\n",
    "score = model.evaluate(x_test, y_test, verbose=0, batch_size=128)  # 不写默认是verbose=1，打印进度条记录，0不打印。\n",
    "print('Test loss:', score[0])\n",
    "print('Test accuracy:', score[1])\n",
    "# p_pred = model.predict(x_test)\n",
    "# print(\"p_pred:\\n\", p_pred)\n",
    "label_pred = model.predict_classes(x_test, verbose=0)\n",
    "print(\"label_pred4test:\\n\", label_pred)\n",
    "print(\"label_init4test:\\n\", y_init_test)\n",
    "label_pred4train = model.predict_classes(x_train, verbose=0)\n",
    "print(\"label_pred4train:\\n\", label_pred4train)\n",
    "print(\"label_init4train:\\n\", y_init_train)\n",
    "\n",
    "# 绘制acc-loss曲线\n",
    "history.loss_plot('epoch')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
